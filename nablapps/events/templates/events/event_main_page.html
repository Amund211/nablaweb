{% extends "base.html" %}

{% block main %}
<style>
 #dash {
     display: grid;
     grid-template-columns: 1fr 1fr;
     grid-template-areas:
         "penalty user_events"
         "event_list event_list";
     justify-items: stretch;
     grid-column-gap: 40px;
 }

 @media (max-width: 600px) {
     #dash {
         grid-template-columns: 1fr;
         grid-template-areas:
             "penalty"
             "user_events"
             "event_list";
     }
 }

 #penalties {
     grid-area: penalty;
     align-self: end;
 }
 #user_events {
     grid-area: user_events;
 }

 #penalties, #user_events {
     padding-bottom: 7px;
     border-bottom: 1px solid black;
 }

 .header_like {
     font-size: 1.4em;
     line-height: 1.3em;
 }

 #event_list {
     grid-area: event_list;
 }

 .event_list__event .header_like {
     line-height: 2em;
 }

 .month__name {
     color: #507eff;
     border-bottom: 1px solid #507eff;
 }

 .penalties__questionmark {
     display: inline-block;
     border: 2px solid rgba(0,0,0,0.5);
     width: 20px;
     height: 20px;
     border-radius: 10px;
     text-align: center;
     line-height: 20px;
     color: rgba(0,0,0,0.5);
     font-weight: bold;
 }

 .penalties__list {
     position: absolute;
     background: white;
     border: 0.4px solid black;
     box-shadow: 1px 1px 4px rgba(0, 0, 0, 0.3);
     padding: 5px 10px;
     display: none;
 }

 .penalties__list__item {
     text-align: right;
 }

 .penalties__questionmark:hover ~ .penalties__list, .penalties__list:hover {
     display: block;
 }

 #dash a{
     text-decoration: none;
     color: inherit;
 }

 .user_events__item--empty {
     display: inline-block; /* Make the 'no events' text appear on same line */
 }

 .day {
     position: relative;
     padding: 4px 8px;
     margin-bottom: 16px;
     box-shadow: 4px 4px 20px -10px;
     border: 1px solid #00000029;
 }

 .day__date {
     position: absolute;
     right: 0;
     top: 0;
     max-height: 100%;
     padding: 7px;
     background-color: #c67676;
     color: white;
     font-size: 2em;
</style>
<div id="dash">
    <div id="penalties">
        <span class="header_like">Prikker:</span> {{ penalties__count }}
        {% if penalties__count %}
        {% if penalties__count >= 4 %}<span class="fa fa-times" style="color: #c64444"></span>{% endif %}
        <div class="penalties__questionmark">?</div>
        <div class="penalties__list">
            {% for penalty in penalties %}
            <div class="penalties__list__item">{{ penalty.event.headline }}, {{ penalty.event.event_start|date:"j. F Y" }} - {{ penalty.penalty }} prikk{% if penalty.penalty > 1 %}er{% endif %}</div>
            {% endfor %}
        </div>
        {% endif %} {# penalties__count #}
    </div>

    <div id="user_events">
        <span class="header_like">Påmeldte arrangementer:</span>
        {% for event in user_events %}
        <div class="user_events__item">
            <a href="{{ event.get_absolute_url }}">{{ event }}</a>
        </div>
        {% empty %}
        <div class="user_events__item user_events__item--empty"> Ikke påmeldt noen arrangementer</div>
        {% endfor %}
    </div>

    <div id="event_list">
        <div>
            Filter
            <form method="get">
            {% for type in filter_form.type %}
            <div class="filter__option" >
                {{ type }}
            </div>
            {% endfor %}

            {{ filter_form.sort }}
            <input type="submit">
            </form>
        </div>
        {% regroup object_list by event_start.date|date:"F" as month_list %}
        {% for month in month_list %}
        <div class="month">
            <h2 class="month__name">{{ month.grouper|title }}</h2>
            {% regroup month.list by event_start.date|date:"d." as day_list %}
            {% for day in day_list %}
                <div class="day">
                    <span class="day__date">{{ day.grouper }}</span>
                    {% for event in day.list %}
                    <a href="{{ event.get_absolute_url }}">
                        <div class="event_list__event">
                        <span class="header_like">{{ event.headline }}
                            {% if event.registration_required %}
                            {{ event.free_places }} plass{{ event.free_places|pluralize:"er" }} igjen
                            <span class="fa fa-calendar-check-o">{{ event.registraion_deadline }}</span>
                            {% endif %}
                        </span>

                        </div>
                    </a>
                    {% endfor %}
                </div>
            {% endfor %}
        </div>
        {% endfor %}
    </div>
</div><!-- #dash -->
{% endblock %}
