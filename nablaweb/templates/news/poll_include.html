{% load humanize %}{# widthratio #}

{% if poll %}
<br>
<div class="poll well hidden-phone">

    <h4>{{ poll.question }}</h4>

    {% if user in poll.users_voted.all %}
        {# Has voted, display results #}
        {% for choice in poll.choice_set.all %}
            <div class="choice">{{ choice.choice }}</div>
            <div class="progress">
                <div class="bar" style="width:{% widthratio choice.votes poll.get_total_votes 100 %}%">
                    <span class="percent{% if choice.votes == 0 %} zero{% endif %}">
                        {% widthratio choice.votes poll.get_total_votes 100%}%
                    </span>
                </div>
            </div>
        {% endfor %}

    {% else %}
        {# Has not voted, display form #}
        <form action="{% url poll.views.vote poll.id %}?next={% url news_list %}" method="post">
            {% csrf_token %}
            {% for choice in poll.choice_set.all %}
                <label class="radio">
                    <input type="radio" name="choice" value="{{ choice.id }}">
                    <div class="choice">{{ choice.choice }}</div>
                </label>
            {% endfor %}
            {% if user.is_authenticated %}
                <button type="submit" class="btn">Stem</button>
            {% else %}
            <div class="center" style="color:#999;">Logg inn for Ã¥ stemme</div>
            {% endif %}
        </form>
    {% endif %}
</div>
{% endif %}{# poll #}
